test_input1 = "esew"
test_input2 = "nwwswee"

test_input = """
sesenwnenenewseeswwswswwnenewsewsw
neeenesenwnwwswnenewnwwsewnenwseswesw
seswneswswsenwwnwse
nwnwneseeswswnenewneswwnewseswneseene
swweswneswnenwsewnwneneseenw
eesenwseswswnenwswnwnwsewwnwsene
sewnenenenesenwsewnenwwwse
wenwwweseeeweswwwnwwe
wsweesenenewnwwnwsenewsenwwsesesenwne
neeswseenwwswnwswswnw
nenwswwsewswnenenewsenwsenwnesesenew
enewnwewneswsewnwswenweswnenwsenwsw
sweneswneswneneenwnewenewwneswswnese
swwesenesewenwneswnwwneseswwne
enesenwswwswneneswsenwnewswseenwsese
wnwnesenesenenwwnenwsewesewsesesew
nenewswnwewswnenesenwnesewesw
eneswnwswnwsenenwnwnwwseeswneewsenese
neswnwewnwnwseenwseesewsenwsweewe
wseweeenwnesenwwwswnew
"""

input = """
seseseseseswsesesenwseseseswenweeese
nwneneseswneneweeneneeeeneeneene
swswseswswswswswseseeswswswswseswsesww
nwsenwnenenwnwnwewnwnwnwnwnwnwwnwnwnw
sesewseesesenwnewewwnewseeseseswsene
eneneneeewswnenewsenenwnwnenewnene
neneneswseseeeswsw
newneeeeneeeeeeeene
wnwwwswwwnwewnwwsewenwwwwnww
swewswswseseseswseewseseseneswnewwsesw
nwswnwsenwnenwwnwnwnwwnwwnwnwnwwnwnwnw
swwwwwnewwwwswswwwwwwseswsww
wwwewwwwswwwwwwwwwswsw
wnwnwnwnwnwnewwnwwnwnwnwsewswwnwww
sweswnwwwnwwnwnwnwseenwnwnwnwnenwnwnw
nenwwwsewnenwwwwwwnwwnwwswnwnww
eeneeesweeesenwneneeeenweeeene
enwwswnwwnwnweswnwnwseswnwnwnwsewnenenw
nwnwnwnwnwswnwnwnwnwnwnwnwnwnesenwnwnwnenw
nwswwsewswwwwww
sesweseeneeswnweeseweseswsesenwnw
sewswwnwneeswswnewswswswwwwnwswwse
enwnwswnwnenwnenwswneneneneneswnwsewnenwnw
nwnenwnwsenwnwnwnwnwwwnwnwnwnwnwnwnwnw
seesesesesesewsesesesesesesesesesesesene
swneneseswsewswwsenesesewswwnewswseswne
swnwswsenesewneswswnwswsewewswseswnene
wwswwseseswwnwnww
esewnwseseswnweseesenwswseesesesee
seeneneneseenenwsweeeeeeeewe
seseswseswsewseseswsweseswseseswswsese
swneeneeneseneweesewne
nenenenenenenenenenenwnenwsenenenenenene
neneneswneneneneneneswnenenenwenwnenene
wewwewwwnwswswnwewwwwwwwsw
seseseenwsweeeesenweneeeseewse
neneneneenenenenwnenenenewnewnwnwnesenw
nwnwnwwewwseswnesewnwswwseswenene
wwswswswswswwswswsweswswsw
nwnewnwwsenwnwnwnwwnwwnwsenwwwnwwsenw
swweeenwseeseseeenwweseeseseeese
nwnwnwnenwnwnenwwnwnwnwnwnwnwnwnwnwnwe
nwnwnwnwnenwnenenenwenwnwnwnwswnwswnwnw
wwwswwewwwwwwwwwnwwwwwsw
neneneneneeneeneenenenesw
nwswneeneeneseweneeweneneswnwswneswse
seeswwenwneeneeeneeswneeswsenwe
weewwwwwswwwnewwwwnwwwsww
wneseewneweswneneneneneneeswnenesene
swnwenwenwseswneswewnwwnwwsenwnwe
wsewnenenenenenenenenenwnesesenenenene
nenwneneneeneneneswnenenewneenenenenene
eswswswwswnwwswswsweswnwswswswwswe
seeseseseseeeswsewnwneseseesesesese
eseenwseseesweeeeseeweeeesee
eenewneeneneeneeneeswneneneswsene
nwnwsenwnenwnwnwnwnwnwswnwnwnenwnwnwnwnwne
wnwwnweeseswnwnwsweesenewnwnwnwnw
nesweneenenwnwneneswneneseewene
nenenenenenenenenenenwsenenenwneneneeswnenw
swswsweswseswswseswseswswswnwnwsenwswsee
wwnewwwwwsewwewsewnwswwnwnew
swswswseswswswswswseswswsewsweswseswsw
eeneenesweeeeeeeeeneenweee
nwwwwwwnewnwwwwswwww
nenwnwneeneswnwnwnwswnenenwnewswnwswnw
eseseenwsesesesesewsesesesesesesesesese
wwnwwnwwnwenwwnwnwnwnwnwnwsenwswnw
sesewseseeeneewesenwseeseenesee
seeesewsesewwneeeeeseeeeenenw
wswswswswswswwswwwswewwwswwwsw
eswwswswwwwswswseswwwnewwwwwwsw
weseswseeswneseswwsewswseeewnenwsw
nwnwnwnwnwnwenenwnwenwnenwnwenwnwwswsw
senwnenweesesewwesweeeseneneew
nwwnenenenwneeneneneswneneswwsewseene
wswwwewswwewsw
eswneeeeeeeeswneeneeeneenwe
nwseeswnwsesweseseseseseeneswneseseese
eeseesenweeee
senwnwsenwnenwnwnewnenwnwsenenwnwnwswnw
neenwsesewnwnewnwnenesenenwnewseswnene
eweeenwesweeeeeeeseeswneee
eeeswnweeeeneeeeeweeeeee
nwnwnenenenwneneswnwnwnenenenwnenwnesenw
eeweeeeeseseeeeeeeeeee
wswswwsenwwnwneewesewswwnewnew
nenesenesenwnenenwswwnwnenenenenenenee
nenenwenwnwnwnwswnenwneneswnwne
wwswswswwswwwneswwnewww
enwnenwnwwnwnwnweswnwnwnwnwnwswnwnwnene
seseswswswseseswseseseswsesenwseswseswe
newnenwseneeeneneswnenenenenenenwseenee
eeswseeswsesenweeenwsewsee
wnwnwenwnwwnwnwnwwnwnwwnwnwnwwnwnw
nwnwnwnwnenwnwnwnwnwnwewnwnwsenw
swswnwsweswswswswswswswswswseswswswsw
swswwswswswwswswswswswwswwswswweesw
swswswesweswnwswwsenwseswswewnwswswswne
wwwnwwwwewwwwwwwwwwew
wwnwwwwwnwwwwwnwwnwsewnenwnw
nwnwnenwnwnwenwnwswesenwnwswseneneww
newseseesewseweenesesweneewswe
wenwwewswnwwnwnwwwnwenenwsw
neeeeneneneeeenwneswswneswneenesw
seeseseseseswseseeseneseseswnwnwsesewese
eeeeweneeenweenenweeesesesesw
eswnenwneeneenesenenwneseneenwswnenenew
nenwnwwnwnwnwnwenwnwnwnwswnwneneneenw
nwnwnwnwnwnenwnwneenenwnwnwwnenwnenenw
eeeseeeeeeeseweeeewsee
wnwwnwwnwwwwwwnwsenenwnwwwnwww
eseseneesesewnwesweneneswsenweewsw
nwnwnwenwnwwnwnwnwswnweenwnwnwnwnwnww
nenenenwswnenwnenenenwneenenenesenenenene
neeswnwnenenenenenenwneneneneneneeneswne
swseenenwneeneeeeseneenwnenenenee
neswnwnenenenenwnwnwseewnwnenwnwnenene
senwseswsweseseseseswsesenwnwseseneseenw
eneeneneeneswswewneneeswneenwnenw
neenwwneswswsesenesewwsesesesenwwe
seseneseewseseeesewseseseswnwsesene
sesenesesesesesewswseeeseseseeesese
wnenenwnenesenenenenenwneneewnenwsesenw
sesesesesesesenwseseneseseseseseswseswsese
sweswneswswswswswswswswswswswswwswwswsw
nwsweswnwnweseneswsesenewnenwswneenew
neeneneenesweeseenenenewneesweeene
neneeenewwseewneseeeseneenwee
seseseseseeeeeeeseweeseseese
enwswneeeneeseneeneeweeeeenesew
eswswswswswswwnwseseswseeswnwseswswsw
nwewswswwswswswnesewseswswnesweswsee
nwnwenwnwwsenwnwnwnenwnenenwnenwnwnwnwsw
eneneneneneneenenewneneneeneneneene
nwnwnenwnenenwnenwsenwnwnwnwnenenewnwswnenw
wwwnwwswnenewswwseswwwnenewsew
ewwswneenenenwswwnwewenenenewese
nwenwnwnwneseseswnwnwnwswswwneswnwnenwne
nenwenwsenwnwneswnwswnenenwnewnwnwenwnw
wnwnwenwnwwnwnweneswnwnwnwswnwnwnwnwnw
eneeswneenewneenenenewsenwnenee
enwnwnwnwnwnesenwnewnwne
nwwnwwnwnweenwsenenwwwsenwwwswne
wwwnwsweewneswweeswweswsewnw
swseeswwneswseswwswseneswnwswswswwswswsw
enewenweswsesesesewswneeenwwwse
senwnenwnwnwnwnwnwnwnwnwnwnwnwnwnwwnwnw
wsewnenesenwenwswnwnenwswnwnwnwwenwe
wnwwnewwnewwnwnwsewnwnwsweswww
seswswseseseeswnwnwsenweeswnwseswsesese
nwnwwnwneseweenenwnwnenwswneeswseswne
swnwnwswswswswswswswseswseeseseswswsese
nenwnenenwsenenenewnwnwnwnwnenenesenenw
swnwwwwesewweewnwwesenwnwnwnw
swwswseneswwneswsenenenwswneseswswsenenesw
nenenenenenwenesenenenenewnenwnwnenenwne
swnwwswwwswswwswwswwwwseeswsww
eseseseeseseseweseseseseseweee
swsweswswswseswweswnenwswenwwswswne
nwnwnwnwnwnwnesenwnwnwnenenwnenenwnwnene
neswwwwwnewwewseweswwwswww
seseswseneseeseswnwseswseswseswseseswse
sweeeeeweseeeeenwenw
swnwnweewwnwsenwsenwwnewswnenwnwsw
eweeeneenwwseneneswnesewnwseesenwne
swswswswnewwwswswsewwwnwwswweswsw
nwnesenenwewsenwwneseseneswnenenesenw
ewnwenenwseseeneweeesewsw
eeeenwenenweeenweseeneseeseee
esenwseesesesesesweee
sesesenwseswnwswsenwseseenesewsewnwnw
wnwwwwwwnwswwwwewwwwwwww
nwnwsenwnwnwnewnwnwnwnwnwnwwenwnwnwnw
wsewwswwneswwswswwnewswswwwnese
nwnwnwnenenenwnwnwenwwnenwnwnwnwnenenw
nwnwnwnwewnwwnwnwwnwnwwnwnwnwenwnw
wswwswswsewnwswwswsewwwswwswnew
eeewseeeeseneeweeeeeeee
nenenenenenenenenenenenenenenenenenenesw
nwnwnwnwenwnwnwnwneswnwnwnwseenwswwnw
senenwswnenenenwnenewnesene
seswseseeneseneseseeseseseeseseswese
nenwswnwnwsenenwsenwnwsenwnwneswnwwnwenwnw
eeweseneseseseseseeeseeese
swewnwwswwswswwwwwwnwwsewww
swneneneneneeswwnewswseneswneneenenenene
eenwneeneneeseswseneenwnenenenene
sewswsweswseswseenwsenenesese
seswseseswseseseseseseswseseseswseseenw
sweeeeeeeneeseeeseseeee
seweneeswnwneeeeneneenewnesenwne
swwswewwnwnwwnwwewwwwwwnwnwwnw
neneneneneneneswneneneneneneneeneneswnene
wwwnweesenwnewnwswnwnwnwwnwnwnwww
wswnwnwnenwweswewwswswwsewswwsw
sewseseseeeeneseeeeeeeeesee
senenewneseenwneneneneeswnenenwnewnene
neneneeeseneenwneneenwneseneswneeeww
swswswswswswswswswwswswswswsweswswsesw
neswwwswwswwwwewswswewsewswwnw
neneneesweeneneneneneewnenenwnenenene
eswswnenenewneseneneeswnewneesenenene
nwnwnwnwnwnwnwwnwwwnwnwnwswnwwswenwne
seeseesenwswnwesweseneneeeseeeee
eeeeneneneneeneneewneeeseene
seswwswswswswsweswwnwsweswswswswnenw
wwwwneseswwwnwswsewswwswwwswsww
wswnwswswswsesewwwwwswwswwneww
wseswswewswswswswseswewswseswswesw
swnweswwwwswswswswwswww
wswwswwswwswswwnewwsenwwwwswew
neseneenewswwesweneseese
wwwsenwswsewnwnwesweenwwswwnwww
wswnewswsewnwswwswswnewswswswswswwsew
swwswwneseswswswww
neneswnweseenwswneenenweeeeneenee
eenenenwseewseesewswseeeeseeew
enewnwwnwwnwwseneswwwwswnwwsenwnwne
eweseewseeseneneseeseeseenwwsese
neswwswenwwwwwnesewswneswwswsesw
nwnenwnwnenwnwnwnwnwnwnwnwswenenwnenwnw
swnenwnwnenwnenenwnwnwnwnwnwneewsenwnenwne
nwneenwnwnenwnwnwnenwnenwnwnwnewnw
swswseswswswswswswswnwseswswswneswsenwsesw
nwnwnwnenwnenenwnwnwnwnenwswnenwnwnwnenw
nwwnenwnwnwnenwnwsenwnwnwnenenwnwnenwne
neeseewwswseenenw
swwseswswswneseswswswesesenwswneswsesw
newnwwwnwnwwwnwsenwwnwwwesenwnwnw
eswseseswwswseneswsesesesesesenwsesesese
eeeeeeeeeeenweeeeseeee
eesenesewseseeseeeseseeeeseesese
wnwnwnwnwnwenwswnwwnwnwnwnwwwswnwnwnew
nenenwnwnwwesesenwwswnwnewswswswenw
eeseeenwnwswswewnwsweneeenwsenee
eseenwsesweseweeseeseseeswsesene
sesewseneseswsesesesesesesese
nwnenwnwnwnenwswnwenwnewnwnenenwswneene
wwwwwswwwnwwwwwewwwwwww
eseesewseeeseseseeseesesesenesesee
swswewwewwewsw
swseswnwswseeswseswswswswswswswseseswswse
wnwnwwwewwwwwwwswnwnwsenenwww
swswswswswswswseseneswswswswswswswswsww
wenwwewwwswsweswswsenwwswwneew
nwnwneeneswneneneewneswnwneneswnwswnw
wsewswnwnwnwwenwnwnwnwnwnwnwewnwnesw
swswswswswneseswswswswnenwse
eswnenenwseswseseswseseseswseswneseswnw
enenwnwsenwnwnwwneswnenwnwnwnwnwnwenw
sewsesenesewewseseseseseneweseseewse
sesewseswseseswseseseseseswswswseswsenese
neesenenenwneneenenesewneeneeewnw
senenenesenenewwneneenwneneneeenenene
wwwwwnwwwwwnewsewwwwwww
swseswwswswswnwswneene
sesesesesenenwsewseswnesenwwsenenwsewne
nwwwwwwewwww
neneeneeeeswnenenesenwneeneneenenew
eweeeeeeeseneeeeeeewee
newnwnenwnwwwwwswwswwwnwwnwwwnw
nenwnwenwnenwnenenwnenenwnwsenwnwnenew
wswseenenwnwwneswnenwwnenenenenenee
swswnwsweseseswswswseseswswswseswswseenw
seseswswnwseseswwnwsweseseseseseeseswe
nwnwnwwwnwwnwwwnewwwnwsesewnwwnw
swswseweeswswswsewswswnwwwnwenenwsww
eswswesesesesenweseseseseneneseewsenese
wnwenwwwwnewwwwnwnwwwwsw
seeeenwswwsenwsesenwswneswswwwswe
nenesewwwswswswnwswswnewswsw
neseneseswseeseseewswwsewswsenwswswsw
eeseeeseweeneeeeeeeeesesee
sesweenenenweeseeswesweseeeneww
nwnwnenwnenwwswswnwwwse
nenenwswneneesewenenwesenwnenenesene
eesewnwseeneeeeeneseesewwnwe
swenesesenesenenewwnwnenenenesw
swswswswswswswswnwswswswswswswsweswswswsw
eseneswseseseseseseswswsesenw
swsweswswsesenwswswnewswswswswswswnwswsw
wwwneswwswwwneswwsewwswwwwsw
nwnwnwwnwnwnwwnwnwnwnwnwnwenwnwnwwnw
wswwswwwewswswswneswswwwswwwwsw
nenwnenwneenwnenwnenwnwswwnenenwnwnenwnw
seeseseeseeseseweeewnenesw
senwnwnwnwnwnwnenwnwnwnwnwnwnwwwnwsenw
enenesenenwwesewee
swnwswnwneseenenenwswnwnewnenwwnwneesene
swswswseswswswswswswswswswseswswwseesw
swwswnwwwwwwswwewe
wswenewnesesenwswseswseeneneenenwnenwe
wwnwswswewswewww
seseesesesesewsenwseneseseeseseeeww
swseswswswswswseswswseswseswsenwseswswse
wnwwwwwsenwnwweswnwnwsenwewwsw
nenwnwewswnenenenenwnwswnwnwnenenenenwnw
wnwwnwnwnwenwseswnwswenwwwnwwnww
neenwnwswnwneneneenenenwsewneswnwnenwnw
wwswswwwwwwwswwwwnewswnewww
wsenwswsweswewneenweswsenwneneese
swseswnwseseswseseswseswswswseseswseenwse
seswswseneswsesesweseseswseswneswnwwswsese
nenwenwwnwneswnwenwnwnw
neswewnwnwswneenwsenwswnwnenenwnwenenw
eswswnwnwnenwwnwnwswnwnwwnenwnwnwsenw
nwnwnenenwnwnenwswnwnwnwnwnwnenwnwnw
wwwswwwswwwwweneeeswwwwne
eeeenenwneneneneeneeswneeneweee
nwnwnwnwsenwswnwnwnwnwnenwnwnwnwnwnenwnww
swsesesesesesesesesewesesewseseseseseswne
seseeeseeeweeeeeesesewsesee
seswneseswneswsenwenewwsenwsenweswswene
swswswswswswswswswswswswsweeswnwsesww
swwswswswswneswswwswswswwswwwsw
swnwseswswswswswwswswwswswswswswswswsw
nwnenwnenenwswneneneneswnwneenenwnwnenwnene
nwnwwnwnwwsenenwnwnwnwnwwnwwsenwsenw
seseeesesesesesesesenewseeewsewse
swswswenwneneeeenwneenwnwsenene
seseswsewesesesesewseswsenweenwsese
eweeeeesweeenweeeeseee
eseswseswsenwswseswseswswswsw
ewnwwnewnwwnewnwswswnwsenwwnwwwwe
esesenweseseseseswseseseneseseesesenwse
wsweswswwweswwwswswswwwewwswnw
nwnenwnwnwneenenenwnwwnwnwnwnenwwene
seewsweesenwnwwsee
swneswwwswnwenwewswnenwwswseewswswe
eeeeeeeeeeeeseeenwee
sesweeeeseenwenw
wswswswwswwnewseenwswnewswswswswwsw
seswseswneswnwnenwse
senenwswswsenwswseswsenwneeseseswseswse
nwswswswseswneswswseswseseseeswsenesesw
weweswwwswnwwwseswwwnewwnwwsw
neeneeneswneeeeeeneneeneenweene
nwnesenesenwseesewseseseseswesenwew
sesesesesenwnweswweseeeswseneeese
wnwwwewswwwwswewwswwwwnwwww
wswwwswswewwnwwswswswwwswwswww
eeeeeseseeeeneeweeseeenwee
seeeeseeeseeeeeeesesesenwee
seesesenwwswseseneseseswseseseseseseswsese
newwwwswwswwwswwswweswswswsww
nenwnwswnwnwnwnenwnwnwnenenenenwnwnenenw
wwsewwsenwwnenewwnewsenww
swswswswswswswswseseswneseswswswswseswenwnw
seesenwnenewseseswswswwnwseseesesesese
enweseneeneeseeneeeseeweewwee
eeweeeeeeesesenewnwseseesesese
wswsenesesenesesewseenwswswnenwswnwenenw
eswseswesesenwewswwnewnenweswsese
nenwnwneswnwnwnwnenenwnenenwnwnwnwswnwne
nwnenesenenwwneewnwnwnwwnwnwnwnwsenw
seswseswswseseswswneswswswswswswswswsw
nenwneneenenenwswnenwneswneenwneswnenenene
seswswseseswseseswseseneswswseswswseswse
swswseswnenwswswseswswswswseswseswswswswsw
wswwswswwneswswwsweswswswwswsw
nenenesenenwnesenesenenewnwnenwnwnwswsenw
wneenenwnenesesenewnwswnwenwneswnene
sewenwwwwwwseenwnwnwwwnwswwnwne
ewwneeneneeseeesewneneewnewne
nenenesenesenwwneneswnwnweneswswsenwne
weseeeeseeeneneweseseswsewwnw
nwwwswwswsesewswnwswswswwnweswswe
weswwwewwnwwswwwnwseewwwnw
seswswseswseeseswswnwsewseswswnewswswe
sesenwswesenwswseseseseseswswswswswswswsw
wnwnwesewsesewwswnwnwwewnewwnee
seseeseswwswswseswsw
swwnwenwseneswwneenwnewnwnesewswnesee
nwwnwnwnwsenwnwnewnwnwnw
esesewneseeeeeeesee
senwnesewnwnwnenwwswnwwnenesenwnwsww
seswsewswswesewseseseseseneswswsesesw
neseseswwenewswswswnwswsewsesesenesw
senesenwnwswsesewseseswswseseseseswsee
enenenenewneeeneneneneenenenesenenene
wwwwnwnwnwwnwnwnwewwwnw
wnwenwnwnwnwswnwsenwseswwenweenwnwsw
nwnwnwnwenwnwnwnenewnwnwnenwnwnwnwnwnw
seseseenwswnwswswswswseseswneneseswswwsw
neeenwnenwwwnewnenenwnwnesenenenenw
swsenwwnwseneesweswseneneeeneenwwswse
eeeeeseneneeeneneneneeneweesenwe
ewseeswneewenenweeeweneneeeene
swswswswswseneswwswswseswseseseswseswsee
eeeseseseseseseesenwseeeseseseswsese
nwnenenenenewnenwnenenwneswseenenenenenenw
swsesweseswswsenwswseseswswseseswswnwse
senenenewenenenenenenenewnenenesene
nesewseneswwsweseswneseseseswnesese
nwnwnwnwnwwsenwesenwnwnwnwnwnwnwsenwnwnw
nenwnwwnwnwnwnwnenwnwneenenenenenene
wswwsenwwswswwewnww
wwwnewwswwwwwwsewwwwwswww
wswseseneswewseneswswnwswswsenesenwswe
wnwnwenwwnwnwwswswwwnwnwwsweenwnwnw
wswweswwwswnwswswwwwseewswswwnw
swswwwwnwswsweswwswwswswswswswwsww
neseneneeweneneeneneneneneneneeswnenw
nwswswswswswswswswswsesw
nwnwnenwnwnwswnwnwesenwnwnwnwswnwnwswnenw
neswwswseswseneswswseswswswswswswseswswse
swseswsweswswseseswseseswswswswswswnwsw
swsweswesweneeneswneenwneneneneene
seseseseseswsenwseseseseswsese
swwswwewwnewwneswwswwwnewww
neneeeneneeseenenweeee
enwwwswnwnwnewswswwnwwweeseww
nwneeenenenenesenweseeneeweneswsw
nenenewneneneneneneneeenenenenenenene
seeseseseseneseeeseswenwnweseswnwseee
swneswseswseswsesenewsesenesewenesw
nwnwwwwwnwwewwnwwwwwwsenwnw
swswswwsewswswwswnwwsweswnwswwwww
seswseseswseswneseseenwseswwsw
newnewesewwswsewnw
weseesesewneseseseesenesesesesesewse
eeeeseeeeeneeeenenewe
wswwseswseneswswswswnesweseswnwswswswe
eweeseeeeeeneneeeseeseeseswese
nweenwwnwnwwnwenwnwnwnwwwswwswnwse
wwwnenwnwswwnwwwwwnwnwnwwnwwnenwse
enenenenenewnwnesweseewenenesenee
esewswnwenwwnwnwnwnwnwnwswnwwwwse
eeweneswenenweswnesweneneeneee
wseneeseeesewnwswswnenesewneswee
swneeenenenenenwnenenenenenenenewnesene
nwswswswwswseswswswswnwswswsewwswswsw
neenwnwnwnenwnwnwnwnwnwnenwnww
eeeswenweeeseeeeeseseeeee
swseswswswseseswseswneseseswswswsese
nenwnenenwnwnenenenwswnenwnenwnewnwenene
nwnwseseseswswseswswseswsweswswswseseseswse
swnewwwwswwwwsww
seseseswsweswswswswseswseseswseswswsww
nwnenewnenwnwnenwnwnenenenenenesenenenwnw
nwenwnenwnwsenenesenwnwswnesenwneew
swwswwseswswswswwenenenwsene
swswsweseseseseswseswswseswnwswnwseswsenw
wsesenewnewnwwwnwsewnwsewwwnwww
sewswnenesewswenwsenwswneseeneseswsw
swwnwswnwwnwsenwnwwwnwwenenwwnwew
seseseeseswneeseseswesesesesenwswwne
neneeeesenenwnenweeneswneeweseeene
swwswswswsewwwswwnenweweewsewnwsw
seeswseswseseseswseseseseseseswwswnese
esweseseseseseeseseseeeseseseeseenw
wswwswwswswswnwswswswswew
nwnwnwnwnwnwnwnwnweenwwnwnenwsenwnwswnw
eeenwnenewneeeneeeneeeeswneneee
nwwnwwnesesweswswswwseseneeswsweewsw
neweneneeneneneweneneesenenenenenene
nwwnweswnwnwswewnwewenwewwwnw
seswsesesenwwseswneseseseeseseswse
wnwwwnwwwwnwwwewwwwwwww
enwseseseseswswsesesesesesesesesesesesesw
wnwnwwnwnwewnwwwnwwnwwwswnw
eseswseenwneenewnwnwesewnweswswsw
neseswwswwwswswneeswwnweswseswnwesw
seeseseseeenweseeseseeseeswseeese
nwseeseseweseseseeseseeesewnwsesese
swswswseswnwseseswswnwnwsweswseseswswsesw
wweenwswwnwwwwnwnwnwwnwswnwwne
senwwwnewwwwwwswwnwwnwsewwese
swswswswswswswswwswneswswswswseswswswsw
wswswswswswwswwwsweewwswswswswswsw
neneneneeewseneneneneneeneneneeswne
swswneswnwswswswswseswnwswswswwswesese
swwwwwwswsewwwwwenewwwww
nwswwwnwswnewsenwesenwenwnwnwesene
nenewwwnenwweswswwwseswswswwew
seneseseseswswseseswsesesew
swsenwweswwwnewnwnwenwseswsenwswesene
nwnwnwnwnwnenenwnwnwnwnwnenwnenwnwnwnwse
swswswnwswswseswswsweswsweseswswswsewsw
wwswseseseseswweswseeswseswneswswse
sweseswswsesewseseseswsenwneswnesesesese
nenenwnwnwnesenenwnwnenwnweswnenwnwnene
eseneesesenesewsw
seseseseswswsesesesesesewnwseseswswsenwne
sweenenenweeneenene
swwesweneenweeeeese
wseseswseeseseswseneseswnwswseswwswseswse
nwseseeseseeseeseeeenwewwewe
wswswwseswswwswswswswwwwswnenwwsewsw
seswswnwswseswswswswneswnewsweswnwnwse
seswseseseswseseswsenwswsesesesesesesesw
nwsenenwseenwnenenwneswnwnwnww
nenwwwnwnwwwsewwwnwwnwwnwnwswnwne
eeeenesweenenweeene
eseweswseeesesesesenwwnenwsweeeese
ewwwwwwwsewwwwwwnwnwnwnwww
seswseseswseesesesesesewneswseseswswsw
wwwwwwnwwwwwewwwwswwweww
newnewsewswsewenwnwwswneswewesw
eneswneswsweeenwswnwswnwnwswswswsw
sesenweseeseeeeeeee
swswenwnwnwwenwwswsewneewseeswsesw
wneswwwnewwneswwseswwswswwwnew
swwwswwsewseseneswnwneswwwwnwww
eswnwswnwneenwneneseneseswneneneenenenw
senewnwnwsweneswseeneseeewewswneswe
swnwseseenewnenwnewne
neneneneseeneeneneewneneneee
nwnwnwwnwnwwwwnwnwwnwnwwnwwsenww
swwneeneswswseswwsweneswwsenwswswswsw
neneswnwnenewenwnenenwsenwnenenwnwnw
seeeseseeeseeeesewsesee
wsewswwsewwswnesewwnwwwenenenwnw
esenweseeeseeeeseeeseeesweenw
enweeseseenwsesenweseseswnwse
eewneewwneeneeneneneseneneenene
sesesenwneswwswswneseseseswswswseseswsene
weesenewnwswswswnweswswseswsww
seseseeseswseeseseseseseseswsenenwseese
nwwewswwsenwnwsenwnenwnwnwenenwsenesw
seeeeswenweseeeswneswswenwswnwwne
swswsenwseenwsenwnenesewnwwene
eeeeeenweeeeeneseseeeewsese
nwenwwnwnwnwwnwswwwnwwnwwnwnwwwe
nwsenenesenwneeneswnwwnwneseewsewse
swwsenwnenwnwnwsenewsenwsenenwewnenese
wwwwewwnwwwwwwww
neneneneneeneenwneneeneneneeneswnene
senesesesesesesenesesesesesesesesewsesw
enwwswwnewswenewsewsenew
nenesenwwseneneseneneneswnenenenewwnenenw
eeeeeeeesweeeeeseeeeneenw
nwnwwnewesewswsweewwwswneesene
seseeseseeeseewseseeseseseneseee
swenwnenwnwsesewswswnwnwenwnwnwnwene
weswnwswswseseeeswneeeswenweenene
swseswseswsenwseseseseswswswseswsesesw
eseneeswnwswwneseene
swswnwswswswswnwwwswnesesewswwsesw
eeweewsenweeeeeesenwsee
seneseswswweswswsesewseesw
weeeeseeseseeeeseeeseseseee
nwsenwswnwnwnwnwewnwwnwnwnwnwwnwwew
enwnwswseseeneswseswswnwseswswsese
neswnwnenenwnenwnenenenenwnenenenenenenw
wswswswswnwswswswswswswsweswswswswwwsw
eeeneneeeeeneeesweweeeene
eneswnwneweneesw
wwwesewswswwwswwnwwwwwswwsw
nwnwnwswnenwnwnenwnenenesenwnwnwnwnwnwnw
eeseeweswseeeeeeeseesenesenw
eweeeneneeeneeseeeeneeeneene
neseseseneseesenwsewsenwseseseseswsesesw
swswenwnewnwwwsenwweewsenwweww
neswswswswswswwswswswnwswswswswsweneswswsw
"""

from collections import defaultdict

def parse_input(text):
    all_moves = []
    for line in text.strip().splitlines():
        moves = []
        i = 0
        while i < len(line):
            c = line[i]
            if c in 'ns':
                moves.append(c + line[i+1])
                i += 2
                continue
            elif c in 'ew':
                moves.append(c)
                i += 1
            else:
                raise ValueError(f"Unexpected character {c}")
        all_moves.append(moves)
    return all_moves

# The hex board looks like

# /\  /\  /\  /\  /
#/  \/  \/  \/  \/
#|  ||  ||  ||  ||
#|  ||  ||  ||  ||
#\  /\  /\  /\  /\
# \/  \/  \/  \/  \
# ||  ||  ||  ||  ||
# ||  ||  ||  ||  ||
# /\  /\  /\  /\  /
#/  \/  \/  \/  \/
#|  ||  ||  ||  ||
#|  ||  ||  ||  ||
#\  /\  /\  /\  /\
# \/  \/  \/  \/  \

# And can be numbered like


# /\  /\  /\  /\  /
#/  \/  \/  \/  \/
#|-1|| 0|| 1|| 2||
#|-1||-1||-1||-1||
#\  /\  /\  /\  /\
# \/  \/  \/  \/  \
# ||-1|| 0|| 1|| 2||
# || 0|| 0|| 0|| 0||
# /\  /\  /\  /\  /
#/  \/  \/  \/  \/
#|-1|| 0|| 1|| 2||
#| 1|| 1|| 1|| 1||
#\  /\  /\  /\  /\
# \/  \/  \/  \/  \
# ||-1|| 0|| 1|| 2||
# || 2|| 2|| 2|| 2||
# /\  /\  /\  /\  /\
#/  \/  \/  \/  \/  \

# Where the top number is the x coordinate and the bottom is the y coordinate.

# So we see that

# E: x += 1
# W: x -= 1
# NW: x -= (1 if y is odd else 0); y -= 1
# NE: x += (1 if y is even else 0); y -= 1
# SW: x -= (1 if y is odd else 0); y += 1
# SE: x -= (1 if y is even else 0); y += 1

def move_hex(x, y, move):
    if move == 'e':
        return (x + 1, y)
    elif move == 'w':
        return (x - 1, y)
    elif move == 'nw':
        if y % 2:
            return (x, y - 1)
        else:
            return (x - 1, y - 1)
    elif move == 'ne':
        if y % 2:
            return (x + 1, y - 1)
        else:
            return (x, y - 1)
    elif move == 'sw':
        if y % 2:
            return (x, y + 1)
        else:
            return (x - 1, y + 1)
    elif move == 'se':
        if y % 2:
            return (x + 1, y + 1)
        else:
            return (x, y + 1)
    else:
        raise ValueError(f"Unexpected move: {move!r}")

def make_moves(grid, moves):
    # 0 (the default) = white; 1 = black
    x, y = 0, 0
    for move in moves:
        x, y = move_hex(x, y, move)
    # print(x, y, grid[x, y])
    grid[x, y] ^= 1
    return grid

def move_all(all_moves):
    grid = defaultdict(int)
    for moves in all_moves:
        grid = make_moves(grid, moves)
    return grid

def adjacent(x, y):
    moves = parse_input('ewnwneswse')[0]
    for move in moves:
        yield move_hex(x, y, move)

def evolve_grid(grid):
    grid2 = grid.copy()
    minx = min(x for x, y in grid if grid[x, y])
    miny = min(y for x, y in grid if grid[x, y])
    maxx = max(x for x, y in grid if grid[x, y])
    maxy = max(y for x, y in grid if grid[x, y])
    # Make sure we go over the bounds
    for y in range(miny-1, maxy+2):
        for x in range(minx-1, maxx+2):
            grid2[x, y]
    for tile in grid2:
        nadj = sum(grid[x, y] for x, y in adjacent(*tile))
        if grid[tile] == 0 and nadj == 2:
            grid2[tile] = 1
        elif grid[tile] == 1 and nadj == 0 or nadj > 2:
            grid2[tile] = 0
    return grid2

# x x x x x
#  x x x x x
# x x x x x

black = "\u2588"

def print_grid(grid):
    minx = min(x for x, y in grid)
    miny = min(y for x, y in grid)
    maxx = max(x for x, y in grid)
    maxy = max(y for x, y in grid)

    for i in range(3):
        print(' '*3 + ''.join(("%3s" % x)[i] + ' ' for x in range(minx, maxx+1)))
    for y in range(miny, maxy+1):
        print("%3s" % y, end='')
        if y % 2:
            print(' ', end='')
        for x in range(minx, maxx+1):
            if grid[x, y] == 0:
                print('  ', end='')
            else:
                print(black + ' ', end='')
        print()
    print()

def evolve(grid):
    print("Day 0")
    print_grid(grid)
    for i in range(1, 101):
        print("Day", i)
        grid = evolve_grid(grid)
        print_grid(grid)
        print(sum(grid.values()), "black tiles")
    return grid

print("Day 24")
print("Part 1")
print("Test input")
test_moves = parse_input(test_input)
print(test_moves)
test_moves1 = parse_input(test_input1)
test_moves2 = parse_input(test_input2)
print(move_all(test_moves1))
print(move_all(test_moves2))
test_grid = move_all(test_moves)
print(test_grid)
print_grid(test_grid)
print(sum(test_grid.values()))

print("Puzzle input")
moves = parse_input(input)
grid = move_all(moves)
print(grid)
print_grid(grid)
print(sum(grid.values()))

print("Part 2")
print("Test input")
print("Day 0")
print_grid(test_grid)
test_grid1 = evolve_grid(test_grid)
print("Day 1")
print_grid(test_grid1)
print(test_grid1)
print(sum(test_grid1.values()))
evolve(test_grid)

print("Puzzle input")
grid_final = evolve(grid)
print(sum(grid_final.values()))
